# Парсер сертификатов и деклараций ЕАЭС

Этот скрипт предназначен для парсинга информации о сертификатах и декларациях соответствия из реестра ЕАЭС с сайта https://tsouz.belgiss.by/#!/tsouz/certifs.

## Функциональность

Парсер извлекает следующую информацию:

### Сведения о документе
- Регистрационный номер
- Статус действия сертификата (декларации)
- Вид документа об оценке соответствия
- Номер технического регламента
- Полное наименование органа по сертификации

### Заявитель
- Страна
- Краткое наименование хозяйствующего субъекта
- Идентификатор хозяйствующего субъекта
- Адрес заявителя
- Контактный реквизит заявителя

### Изготовитель
- Страна
- Краткое наименование хозяйствующего субъекта
- Адрес изготовителя
- Контактный реквизит изготовителя

### Объект технического регулирования
- Наименование объекта оценки соответствия
- Код товара по ТН ВЭД ЕАЭС

## Особенности реализации

- Парсер использует SOCKS5-прокси для доступа к API сайта (настраивается через параметры)
- Для улучшения производительности и снижения нагрузки, парсинг данных за год разбивается на кварталы
- Реализовано автоматическое сохранение промежуточных результатов для предотвращения потери данных
- Поддерживается интерактивный режим ввода дат для удобства пользователя

## Установка

1. Убедитесь, что у вас установлен Python 3.7 или выше.
2. Установите необходимые зависимости:

```bash
pip install -r requirements.txt
```

## Использование

Запустите скрипт с помощью следующей команды:

```bash
python main.py
```

Без аргументов скрипт запустится в интерактивном режиме, предложив вам выбрать диапазон дат.

### Параметры командной строки

Скрипт поддерживает следующие опции:

- `--start-year`: Начальный год для парсинга 
- `--end-year`: Конечный год для парсинга 
- `--year`: Год для парсинга конкретного месяца (используется вместе с `--month`)
- `--month`: Месяц для парсинга (1-12, используется вместе с `--year`)
- `--max-certs`: Максимальное количество сертификатов для обработки
- `--output`: Имя выходного файла (по умолчанию генерируется автоматически)
- `--no-proxy`: Не использовать прокси-сервер (по умолчанию прокси используется)
- `--proxy-host`: Адрес прокси-сервера (по умолчанию: 45.80.68.179)
- `--proxy-port`: Порт прокси-сервера (по умолчанию: 1080)
- `--proxy-type`: Тип прокси-сервера: socks5, http или https (по умолчанию: socks5)
- `--test-proxy`: Проверить работоспособность прокси перед началом работы
- `--start-date`: Начальная дата в формате DD.MM.YYYY для парсинга конкретного периода
- `--end-date`: Конечная дата в формате DD.MM.YYYY для парсинга конкретного периода
- `--interactive`: Запустить интерактивный режим ввода дат

Примеры использования:

```bash
# Парсинг данных за 2022-2023 годы
python main.py --start-year 2022 --end-year 2023

# Парсинг данных за 2021 год с ограничением в 100 сертификатов
python main.py --year 2021 --max-certs 100

# Парсинг данных за конкретный месяц
python main.py --year 2025 --month 3

# Парсинг данных за конкретный период
python main.py --start-date 01.03.2025 --end-date 07.03.2025

# Интерактивный режим ввода дат
python main.py --interactive

# Проверка прокси и запуск интерактивного режима
python main.py --test-proxy --interactive

# Парсинг данных без использования прокси (если сайт доступен напрямую)
python main.py --no-proxy

# Использование другого прокси-сервера
python main.py --proxy-host 192.168.1.1 --proxy-port 8080 --proxy-type http
```

## Интерактивный режим

При запуске в интерактивном режиме (по умолчанию или с флагом `--interactive`) парсер предложит выбрать один из трех вариантов:

1. **Произвольный диапазон дат** - вы можете указать начальную и конечную дату в формате ДД.ММ.ГГГГ
2. **Конкретный год** - будут обработаны все сертификаты за указанный год
3. **Конкретный месяц** - будут обработаны сертификаты только за указанный месяц указанного года

## Результаты

Результаты парсинга будут сохранены в директории `output` в формате Excel. Для каждого периода создаются промежуточные файлы, чтобы избежать потери данных при возможных сбоях.

## Примечания

- Скрипт включает задержки между запросами, чтобы избежать блокировки IP-адреса.
- При ошибках запросов выполняются повторные попытки с увеличивающимся интервалом.
- По умолчанию используется SOCKS5-прокси для доступа к API сайта.
- Если прокси не работает, вы можете указать альтернативный прокси-сервер через опции командной строки.
- Рекомендуется использовать российский прокси-сервер, так как сайт может быть недоступен из других стран.

## Поиск работающих прокси

Если встроенный прокси-сервер не работает, вы можете найти и использовать публичные российские прокси-серверы. Вот несколько ресурсов для поиска бесплатных прокси:

1. [Free Proxy List](https://free-proxy-list.net/)
2. [Hidemy.name](https://hidemy.name/en/proxy-list/)
3. [ProxyScrape](https://proxyscrape.com/free-proxy-list)

Для проверки работоспособности прокси перед началом парсинга используйте флаг `--test-proxy`.

## Требования

- Python 3.7+
- requests
- pandas
- openpyxl
- tqdm
- PySocks (для работы с SOCKS5-прокси) # parser_belaruss_docs
